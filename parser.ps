%!

% Stackbasierte Sprachen - WS 2010
%
% Matthias Treter
% Philip Messlehner
% Perl Thomas
%
% Limitations: Only works with one Tag per Line!!!
% Explanation: Problems with Handlung multiple SearchResults because of readline-Command

% Step 1: Handle Input

% Define Procedure for handling SearchTerm
/analyzeSearchResult {
	pop		%pops trailing (=pre)
	pop		%pops match ('<')
	
	(>) search {
		print	% print the pre stuff = tag
		(\n) print
		flush
		pop		% pops the '>' sign
		pop		% pops rest of line (TODO: work on, to handle multiple tags per line)
	}
	{
		% No '>' found --> broken XML-File or '>' in other line --> Failure
		pop
	} ifelse
} def


/buffer 128 string def				%setup buffer for readline
currentfile buffer readline


/input (input/valid1.xml) (r) file def	%defines Inputfile

{ 
	input buffer readline {			% reading one line (string bool)
		(<) search {			% searching for '<'	(post match pre true OR string false)
			analyzeSearchResult
		}
		{
			pop						%pops string of search command
		} ifelse
	}
	{
		pop		%pops string for readline command
		exit	%and exits loop
	} ifelse
} loop

input closefile						% close File